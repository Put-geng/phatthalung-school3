<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="photo-Class/favicon-logo.png" type="image/png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
    <link rel="stylesheet" href="CodeCSS/nav-bar.css">
    <title>โรงเรียนพัทลุง</title>
</head>
<body>
    <div class="bg"></div>

    <!--nav-bar-->
    <nav>
        <div class="navlogo">
            <img src="photo-Class/favicon-logo.png" alt="icon-image" class="nav-logo-img">
            <div class="nav-logo">โรงเรียนพัทลุง</div>
        </div>

        <div class="menu-icon" id="menu-icon">
            <span class="material-symbols-outlined hamberger-icon">dehaze</span>
        </div>

        <div class="nav-link" id="nav-link">
            <a href="class-peaple.html" class="nav-link-active">
                <span class="material-symbols-outlined nav-icon">folder_shared</span>ข้อมูลนักเรียน
            </a>
            <a href="Check-class.html">
                <span class="material-symbols-outlined nav-icon">browse_gallery</span>ตรวจห้องเรียน
            </a>
            <a href="" id="NameUser" class="no-after">
                <span class="material-symbols-outlined nav-icon">account_box</span>ชื่อผู้ใช้
            </a>
        </div>
    </nav>

	<!--header-->
	<div class="inline-head">
			<div class="green">ข้อมูลนักเรียนในระดับชั้น</div><div class="yellow">มัธยมศึกษาปีที่ 3</div>
	</div>

	<!--main-->
	<section class="class-section">
		<div class="class-grid">
			<a href="class-3-1.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.1</div>
			</a>

			<a href="class-3-2.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.2</div>
			</a>

			<a href="class-3-3.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.3</div>
			</a>

			<a href="class-3-4.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.4</div>
			</a>

			<a href="class-3-5.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.5</div>
			</a>

			<a href="class-3-6.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.6</div>
			</a>

			<a href="class-3-7.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.7</div>
			</a>

			<a href="class-3-8.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.8</div>
			</a>

			<a href="class-3-9.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.9</div>
			</a>

			<a href="class-3-10.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.10</div>
			</a>

			<a href="class-3-11.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.11</div>
			</a>

			<a href="class-3-12.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.12</div>
			</a>

			<a href="class-3-13.html" class="class-box">
				<span class="material-symbols-outlined group-icon">groups</span><div>ห้อง ม.3.13</div>
			</a>

		</div>
	</section>

    

    <!--alert-box-->
	<div id="alertBox" class="custom-alert">
		<img id="alertIcon" src="" alt="alertIcon" class="alert-icon">
		<span id="alertMessage" class="alertMessage"></span>
		<button id="alertOkBtn">OK</button>
		<button id="backbutton"><a href="index.html">กลับหน้า Login</a></button>
	</div>

    <script>
        document.getElementById('menu-icon').onclick = function() {
			document.getElementById('nav-link').classList.toggle('active');
		}

        /*ส่วนฟังชันเข้าสู่ระบบ*/
		const form = document.querySelector('form');
		const nameUser = document.getElementById('NameUser');

        /*ถ้ามีข้อมูลอยู่แล้ว (เช่น reload หน้า) ให้ดึงกลับมาแสดง*/
        window.addEventListener('load', function() {
			const savedEmailNumber = localStorage.getItem('email');
			if (savedEmailNumber) {
				nameUser.innerHTML = `<span class="material-symbols-outlined">account_box</span>${savedEmailNumber}`;
			} else {
				nameUser.innerHTML = `
					<span class="material-symbols-outlined">account_box</span>ชื่อผู้ใช้
				`;
			}
		});
		
		
		/*เมื่อกดที่ชื่อผู้ใช้ ให้แสดงข้อมูลที่กรอกไว้*/
		nameUser.addEventListener("click", function(e) {
			e.preventDefault();
			const savedName = localStorage.getItem('username') || "ไม่พบชื่อผู้ใช้";
			const savedEmail = localStorage.getItem('email') || "ไม่พบอีเมล";
			showAlert(`ชื่อผู้ใช้ : ${savedName}\n อีเมล : ${savedEmail}`, "success");
		});
		
		
		
		function showAlert(message, type="success", redirecURL=null) {
			const alertBox = document.getElementById('alertBox');
			const alertMessage = document.getElementById('alertMessage');
			const alertBtn = document.getElementById('alertOkBtn');
			const backbutton = document.getElementById('backbutton');
			const alertIcon = document.getElementById('alertIcon');
			
			alertMessage.textContent = message;
			
			if (type === "error") {
				alertIcon.src = "https://cdn-icons-png.flaticon.com/512/1828/1828843.png";
				alertBox.className = "custom-alert show error"
			} else {
				alertIcon.src = "https://cdn-icons-png.flaticon.com/512/845/845646.png";
				alertBox.className = "custom-alert show"
				backbutton.className = "show"
			}

			alertBtn.onclick = () => {
				alertBox.classList.remove('show');

				if (redirecURL) {
					window.location.href = redirecURL;
				}
			}
		}

		const classBox = document.querySelectorAll('.class-box');

		classBox.forEach(box => {
			/*สร้างปุ่มดูข้อมูลแบบไดนามิก*/
			const btn = document.createElement('button');
			btn.textContent = "รับชมข้อมูล";
			btn.classList.add('view-btn');
			box.appendChild(btn);

			/*เมื่อคลิกกล่อง*/
			box.addEventListener('click', (e) => {
				e.preventDefault(); /* ❗ ป้องกันไม่ให้เปลี่ยนหน้า*/
    			e.stopPropagation(); /* กันการส่ง event ต่อ*/

				/*ป้องกันการคลิกปุ่มซ้ำ*/
				if (box.classList.contains('show-btn')) return;

				/*ลบสถาณะของกล่องอื่น*/
				classBox.forEach(b => {
					b.classList.remove('blur', 'show-btn');
				});

				/*เพิ่มเอฟเฟคให้กล่องนี้*/
				box.classList.add('blur', 'show-btn');
				e.stopPropagation();
			});

			/*เมื่อกดปุ่มดูข้อมูล*/
			btn.addEventListener('click', (e) => {
				e.stopPropagation();
				const link = box.getAttribute('href');
				if (link && link !== "#") {
					window.location.href = link;
				}
			});
		});

		/*เมื่อคลิกที่อื่นนอกจากกล่องให้ปิดทุกอย่าง*/
		document.addEventListener('click', () => {
			classBox.forEach(b => {
				b.classList.remove('blur', 'show-btn');
			});
		});
    </script>
</body>
</html>